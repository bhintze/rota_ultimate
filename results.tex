\section{Results}
In the Top8000 system there are a total of 235 named rotamers which reach above the 0.3\% outlier cutoff and include $\ge$ 4 datapoints. Many of the central values have shifted somewhat from the Top500 system, both because of much more and higher-quality data and also because of the new center-of-mass definition (see Section \ref{sec_md:chi_stats}), which we feel represents the clusters better than either the modal or the common-atom values defined previously \cite{lovell2000penultimate}. MolProbity's "ultimate" rotamers and their parameters are given in two tables: the table in Section S4 describes the frequency and count of each rotamer in each residue type and the tables in Section S5 give central dihedral and covalent angle values for each rotamer. The latter numbers are available in CSV format on GitHub under \texttt{Top8000/Top8000\_rotamer\_central\_values} at \url{http://github.com/rlabduke/reference_data}. The more useful multi-dimensional distributions are also on GitHub, as linked in Section \ref{sec_md:contours}.

The order-of-magnitude increase in size and quality of our reference dataset greatly improves signal-to-noise, allowing us to do a better job of the same functions as before. More importantly, it enables new features and new conclusions. The simplest view of a rotamer is of a favored sidechain conformation described by the list of dihedral angles, with ideal staggered $\chi$ values between sp$^{3}$ atoms and little preference for $\chi$ between sp$^{3}$ and sp$^{2}$ atoms. The next level of detail adds a standard deviation for each $\chi$. However, conformational preferences are really much more complex, especially in a macromolecular interior where numerous interactions can compensate for the energy required to depart from ideal. We have high confidence in the reliability of our more nuanced conformational distributions, as we took great care to include only physically plausible sidechains that fit clear electron density (see Section \ref{sec:resfilters}). As Figure \ref{fig:outcontour} demonstrates, sidechain conformations do cluster in discrete regions of $\chi$ space. Further, there is large variance in $\chi$ values within a rotamer cluster, the shape is usually not axis-oriented, and its center is rarely at the nominally ideal staggered conformation. A rotamer is better thought of as a local energy well, with a potentially complex shape, describing the favorable extent around an allowed sidechain conformation.

\subsection{Residue Filter Effects}
\label{sec_rs:filterdataset}
Our strict residue-level filtering aims to include essentially only conformations with unassailable reliability, at some expense to the overall numbers. The fraction of  residues kept after filtering differed between amino-acid types (Table S1). Residue-level filtering eliminated the most data, in order, for lysine, glutamate, and arginine. This makes sense since long sidechains are more susceptible to dynamics that can blur or eliminate density. Also, charged sidechains are usually found on the molecular surface interacting with mobile solvent. Hence, surface-exposed positions such as these, lacking strong interactions that can hold them in a disfavored conformation, have no need and no ability to adopt rare, unfavored rotamers. If such sidechains are modeled, they should be in one, or more often several, common rotamers.

\subsection{Rotamer Evaluation}
\label{sec_rs:rotaeval}
The primary purpose of this rotamer library is to analyze the rotamericity of protein sidechain conformations and robustly distinguish outliers. Rotamericity here refers to where a given conformation lies in $\chi$ space relative to the calculated contours (see Section \ref{sec_md:contours}). This evaluation gives a rotamer score between 0 and 100, corresponding to the percentage of the high-quality reference data that lies outside that contour (i.e., how much of the reference data's scores are worse than the given residue). In addition, for scores above the outlier cutoff, the evaluation also assigns a rotamer name. Each local minimum, or cluster, in $\chi$ space is given a name derived from the central $\chi$ values of that cluster. Values for $\chi$s between sp$^{3}$ hybridized atoms are named \textbf{m}, \textbf{p}, or \textbf{t} roughly corresponding to the staggered values -60$\degree$, +60$\degree$ and 180$\degree$. $\chi$s between sp$^{3}$ and sp$^{2}$ hybridized atoms are assigned a number which is the COM value (Section \ref{sec_md:chi_stats}) of the given $\chi$, rounded off. For instance, a Gln rotamer with COM at $\chi_1$ = -174, $\chi_2$ = -82, and $\chi_3$ = -22 is named \textbf{tm}-20.

For validation purposes, users are often most interested in the binary issue of whether a sidechain conformation is rotameric or an outlier, i.e. falls within or outside the rotamer distribution. With the Top500 data, contours were smooth and reproducible (between different datapoint selections) only out to the 1\% level. Due to greater numbers and increased reliability in the filtered Top8000 distributions, a lower outlier cutoff is now feasible as well as desirable, since an even lower percentage of the reference datapoints are now dubious. We also preferred to keep outlier numbers for unfiltered, general data roughly equal between the previous and new systems. Therefore a count of the 1\% outliers by residue type in the unfiltered dataset was performed using the Top500 contours, and those numbers were compared to outlier counts at several different Top8000 contour cutoffs. A new cutoff of 0.3\% matched best, was found to behave smoothly, and happens also to match the 3$\sigma$ level for a normal distribution (3 out of 1000). \textcolor{changecolor}{The table in Section S3 reports the outlier counts in the unfiltered dataset for both the Top500 and Top8000 contours.} Further, along with favored and outlier, a new category has now been added: \textit{allowed}, for scores $\ge$0.3\% and $<$2.0\%. This new category lets users know if a given conformation is at the edge of the given rotamer's distribution, close to the outlier region. This change matches the 3-part system, and the division at 2.0\%, long judged useful for Ramachandran criteria \cite{Kleywegt1996, Hooft1996, Lovell:2003uq}.

An important question is how the new system will change rotamer analysis, specifically the number and identity of outliers. A rotamer outlier is simply a conformation that lies outside the outlier contours of the reference dataset, in this case either the Top500 or the Top8000. For residues that have low-energy sidechain conformations, nothing will change. However, a sidechain conformer in a strained position near the outlier edge could change status between the Top500 and Top8000 analyses. Figure\textcolor{changecolor}{s} \ref{fig:contour_compare} \textcolor{changecolor}{and S1 show} Top500 and Top8000 allowed regions superimposed for \textcolor{changecolor}{all residues with two $\chi$s}. For the most part, the contours overlap, but with some differences near the edges. Asp shows very little change, Trp has a significantly larger allowed region now than in the Top500 system, and the Ile Top8000 contours have tightened up relative to the Top500. Thus, differences are only in low-population regions of $\chi$ space, and overall outlier counts will be nearly identical.

\subsection{Dihedral and Bond Angle Deviations}
As we have shown, rotamers are more complex than just a collection of mean $\chi$ values and standard deviations. The allowed regions are often large and complex, and the mean or modal $\chi$ angles can \textcolor{changecolor}{deviate substantially from the expected staggered conformation}. Such deviations usually occur in well-packed environments where the sidechain makes \textcolor{changecolor}{tight atom-atom} interactions, either via van der Waals (vdW) or H-bonding, with its own backbone (or within the sidechain). The $\chi$ deviations help allow the contact to be \textcolor{changecolor}{a small overlap} rather than a steric clash.

For sidechains that have sp$^{3}$ atoms out to the $\delta$ atom (Leu, Ile, Met, Glu, Gln, and Arg), there are four $\chi_{1}\chi_{2}$ combinations that produce close sidechain-backbone interactions; \textbf{pm} and \textbf{mp} interact with the NH while \textbf{tm} and \textbf{pp} interact with the carbonyl C. Comparing statistics on all $\chi_{1}\chi_{2}$ combinations for these amino acids in the filtered dataset (Table \ref{tab:chi12}), we see that the backbone-interacting combinations are the least populated and that they have large $\chi$ deviations from the ideal staggered positions, especially for $\chi_{2}$. 

Breaking down these statistics by residue type reveals that Glu and Gln make up 54.3\% of \textbf{mp}, 59.8\% of \textbf{tm}, and 92.2\% of \textbf{pm} examples. The likely reason for this is that the terminal oxygens on Glu and Gln can H-bond with their own NH for \textbf{pm} and \textbf{mp}. In \textbf{tm} a strong vdW interaction is made with the C-terminal peptide plane, and the sidechain amide or carboxyl group is generally further stabilized by one, or more often multiple, H-bonds. However, as for all sidechain-backbone interacting rotamers, the dihedral $\chi$ deviations don't tell the whole story -- covalent bond angles also must deviate to avoid steric clashes.

It has long been known that certain sidechain conformations show large deviations in the otherwise narrowly distributed covalent bond angles \cite{lovell2000penultimate}; this is seen in the scenarios above where sidechain-backbone interactions occur. One rotamer of this type is methionine \textbf{ppp}, which has just 48 examples (0.29\% of Met) in the filtered Top8000. Figure \ref{fig:2bmo} shows one specific example and demonstrates how deviations in \textit{both} $\chi$ dihedrals and covalent bond angles are needed to avoid a clash and form a favorable non-bonded interaction. All-atom contacts demonstrate the tight vdW packing. For this residue, the angles C-C$\alpha$-C$\beta$, C$\alpha$-C$\beta$-C$\gamma$, and C$\beta$-C$\gamma$-S$\delta$ each open up from Engh \& Huber values, by +1.6$\degree$, +0.9$\degree$, and +3.0$\degree$ respectively.

\subsection{Interesting Rotamer Anecdotes}
Consistently large deviations from ideal values in the $\chi$ and covalent bond angles for some rotamers raise two questions, which are interesting and sometimes illuminating: (1) What is it about each of these rotamers that requires such deviations? (2) What are the structural features and roles for each of these rotamers? These questions were answered by inspecting individual examples from the filtered dataset. After an interesting rotamer was identified, at least five random examples of that rotamer were selected from the filtered dataset. To visualize interactions for the residue of interest, all-atom contacts were displayed in KiNG \cite{Chen2009}. This process revealed commonalities of the rotamer environment, reasons for the deviations, and possible reasons for a rare rotamer frequency. What follows are select observations from this process.

\subsubsection{Glutamate \textbf{pm20} \& \textbf{mp0}}
Glutamate \textbf{pm20} and \textbf{mp0} make up 2.6\% and 6.4\% of all glutamates in our dataset and would not be considered rare in the context of this paper. These rotamers are of interest, however, for three reasons: (1) some average $\chi$ and bond angles have relatively large deviations from ideal (Table \ref{glupangles}), (2) despite this, these rotamers are significantly more common than other rotamers with similar deviations, and (3) the $\chi$ distributions for both show that all three $\chi$ measures strongly depend on one another, forming correlated datapoint clusters (Figure \ref{fig:Glupm20_mp0}a). In both \textbf{pm20} and \textbf{mp0}, the same carboxylate oxygen makes a strong H-bond with its own NH, but they take a different path to do so (Figure \ref{fig:Glupm20_mp0}b). The large geometry deviations are required in order to avoid a steric clash of C$\delta$ with the backbone.  Glutamine can adopt equivalent arrangements, as previously noted even from much sparser data \cite{Lovell1999}.

The strong sidechain-backbone H-bond, between atoms separated by only 5 covalent bonds, is an important characteristic of these conformations.  It compensates for the energetic cost of distortions better than would a vdW contact, and especially it gives rise to a characteristic interdependence of the three $\chi$ angles: as one $\chi$ changes, the others change in predictably compensating ways to preserve the favorable H-bond.


\subsubsection{Isoleucine \textbf{pp}}
With just 249 examples in the filtered Top8000, \textbf{pp} is the rarest isoleucine rotamer. This rotamer epitomizes most rare ones, by having numerous surrounding vdW interactions to pack the sidechain into this specific rotamer state, which is rare because of strain from its need for large average bond and dihedral angle distortions. The modal $\chi_{2}$ value is +24.3$\degree$ from staggered and bond angles C$\alpha$-C$\beta$-C$\gamma$1 and C$\beta$-C$\gamma$1-C$\delta$1 open, relative to Engh \& Huber, by 2$\degree$ and 1$\degree$, respectively (Table \ref{tab:ilepp}). In \textbf{pp} the terminal methyl is in the "down" position approximately parallel to the course of the backbone (Figure \ref{fig:Ilepp}). In all examples examined, local structure packed the methyl into this rare conformation by sterically prohibiting the more common \textbf{pt} rotamer (methyl "up"). The resulting bond-angle and dihedral openings are necessary to minimize a steric clash between C$\delta$1 and the backbone C.

\subsubsection{Methionine \textbf{mpm}}
Methionine \textbf{mpm} is extremely rare, with only 13 examples in the filtered Top8000. The deviations from ideal are remarkable: C$\alpha$-C$\beta$-C$\gamma$ and C$\beta$-C$\gamma$-S$\delta$ open by more than 2$^\circ$ and 3$^\circ$, respectively, and the modal $\chi_{3}$ in \textbf{mpm} is a mere 20$^{\circ}$ from being eclipsed -- probably permitted by the fact that $\chi_{3}$ in Met has a lower rotational barrier than all-carbon tetrahedral torsions because of the longer C-S bond \cite{Butterfoss2003, Butterfoss2004}. Here, if $\chi_{3}$ were any closer to staggered, the $\epsilon$-methyl would clash with its backbone NH. 

Out of the 13 Met \textbf{mpm} examples in the filtered Top8000, 11 are structurally very similar, with much of the surrounding sequence identical. All 11 belong to the large superfamily of subtilisin-like serine proteases, which contains six families A-F. A large multi-sequence alignment (\cite{Siezen1997}) reveals that the Met is completely conserved in families A, B, and C, absent in D and E, and mostly present in F. The Met occurs in the first turn of a helix that is disrupted n+3 to the Met by a proline conserved in the same families (Figure \ref{fig:METmpm_3d43}a). Most significantly, immediately preceding the Met is the Ser of the canonical Asp-His-Ser catalytic triad (Figure \ref{fig:METmpm_3d43}b). Figure \ref{fig:METmpm_3d43}a shows the extensive contact between the catalytic Ser and the \textbf{mpm} Met. Also shown is the extensive contact between the Met and Ile 246, which excludes the possibility of Met $\chi_{3}$ adopting either a \textbf{p} or \textbf{t} conformation. Although the identity of residue 246 changes across the 11 structures, the constraining hydrophobic contact is maintained. 

This case illustrates that 70\% homology filtering does not always produce independent examples when a rotamer is conserved for functional reasons. In the families where the Met is conserved, it seems structurally important as part of a motif packing tightly with the catalytic Ser.  However, in families where the Met is missing, no other sidechain fills in to sterically position the active Ser.  Therefore the functional reason for conservation must be more subtle, at the frontier of our understanding.  Experimental research will be needed to untangle its effects on catalysis.

\subsection{Conformations Between Tetrahedral and Planar Atoms}
Due to differing physical constraints, dihedral angles between tetrahedral and planar atoms do not follow the well-clustered \textbf{ptm} conformations seen between two tetrahedral atoms: when one planar sp$^{2}$ branch is staggered the other is eclipsed. This is reflected in the Top8000 filtered distributions where sp$^{3}$-sp$^{2}$ dihedrals  (always in the final $\chi$ of the sidechain) often show only weak preferences across their total range (e.g., see Figure \ref{fig:outcontour} for $\chi_{2}$ of histidine).

For the aspartate and asparagine contours shown in Figure \ref{fig:AspAsn}, sometimes $\chi_{2}$ has disallowed regions and sometimes the entire range is allowed. This fact makes it even more difficult, and less meaningful, to assign a central value and standard deviation that adequately describes the allowed conformations. Asp and Asn also show clearly that there is distinct, complex fine-structure of local clustering in the data distributions; \textcolor{changecolor}{note especially the smaller elongated clusters at top right of $\chi_{1}$ \textbf{t}}. These datapoint clusters are primarily due to patterns of sidechain H-bonding to specific backbone donors or acceptors local in sequence, or occasionally due to especially favorable vdW packing against local backbone.  For example, the Asn N$\delta$2 can either H-bond with the i-4 CO in a regular $\alpha$-helix in an \textbf{m-80} conformer or pack against that CO in the more common \textbf{m-20} conformer \cite{Lovell1999}.

Both these issues confirm that a complex probability density function, such as our filtered and smoothed empirical contours, represents sidechain conformational preferences much better than a library of simple box or ellipsoid shapes. Its contour outline at low probability is a definitive way to flag rotamer outliers.  For protein structure prediction or design, the details of favored local motifs at high contour levels should also be considered, preferably with the addition of information both about $\phi$,$\psi$ values \cite{Bower1997} and local secondary structure \cite{lovell2000penultimate}.
