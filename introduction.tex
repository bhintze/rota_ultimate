\section{Introduction}
Protein sidechains take on preferred conformations which fall into distinct local energy minima known as rotamers, defined by the set of sidechain dihedral ($\chi$) angles. For tetrahedral geometry, $\chi$ values fall into three discrete ranges: \textbf{p} (plus, centered near +60$\degree$), \textbf{t} (trans, centered near 180$\degree$), and \textbf{m} (minus, centered near -60$\degree$)\textcolor{red}{, as named in\cite{lovell2000penultimate}\footnote{\textcolor{red}{The p, t, m nomenclature was adopted in \cite{lovell2000penultimate} and in MolProbity \cite{Davis2004}, to give a single letter for use in rotamer strings, and because the more common g+, t, g- terminology was, in 2000, still being assigned to opposite conformations (see discussion in \cite{lovell2000penultimate}).}}}. These correspond to low-energy staggered conformations expected between sp$^{3}$ hybridized atoms \cite{Eyring1932}. sp$^{3}$ to sp$^{2}$ bonds (tetrahedral to planar geometries) have more complex and much broader distributions. Overall rotamer conformations, however, are not simply the product of their individual $\chi$ distributions, since wider steric and other atomic interactions influence the preferred, or even the possible, combinations.

Rotamers have been studied extensively since the concept was introduced by Ponder and Richards in 1987 \cite{Ponder1987}, and they are important tools in structural biology \cite{DunbrackJr2002431}. Rotamer libraries classically catalog favored sidechain conformations by the mean $\chi$ values and standard deviations for each rotamer. They are created by performing statistical analysis on a selected dataset of experimentally-determined models, usually crystal structures archived in the Protein Data Bank (PDB) \cite{Berman2000}. Along with Ramachandran backbone $\phi$, $\psi$ analysis \cite{RAMACHANDRAN1963,JSR_theplot_2013}, these libraries form the conformational criteria used in a variety of applications including crystallographic model building and refinement \textcolor{red}{\cite{Arendall2005, Emsley:ba5144, Adams:2010fk, Winn2011, Joosten2011}}, protein structure prediction and design \cite{Bower1997, Kuhlman21112003, Gainza:2012}, and protein model validation \cite{Laskowski:gl0276, Hooft1996, Chen:2010kx}.

Different rotamer libraries represent the allowed variability around each central conformation in one of three ways. Early rotamer libraries simply provided the mean value and some estimate of allowable range for all $\chi$ angles (or, often, just for $\chi$1 and $\chi$2) of each identified rotamer for each side-chain type \cite{Ponder1987, Tuffery1991,Schrauber1993}.  A user would either simply use the mean-value conformation, or else would optimize it manually or computationally within the allowable range. Because modeling the lowest-energy conformation fails to capture allowed variation and further minimization is computationally expensive, design methods expanded to employ "grid" libraries of arbitrarily-spaced, discrete sample points in $\chi$ space around the low-energy mean of each rotamer, which allowed development of the influential Dead-End Elimination method in protein design \cite{DeMaeyer1997,Gainza2013}.  A third type of rotamer software \cite{Dunbrack1997, Chen:2010kx} evaluates a given sidechain conformation by its position in a multi-dimensional probability distribution. Early such distributions were binned (often at $\ge$ 10 $\degree$) \cite{Laskowski:gl0276}, but recent ones use smooth contour surfaces, scored by what percent of the reference data lies outside that contour \cite{lovell2000penultimate, Read2011}. \textcolor{red}{Design libraries and validation libraries focus on two distinct areas of the reference data distributions. While design and prediction are primarily concerned with statistics and cluster shapes inside the low-energy wells \cite{Dunbrack1997}, validation is primarily concerned with robustly identifying the outliers beyond the edges of those wells. Such outliers are usually wrong but sometimes valid and interesting, so they provide a short list always worth examining [Richardson 2013 COSB validation].}

Because rotamer libraries or distributions are an integral component of modern structural biology, it is imperative that they provide only authentic, low-energy sidechain conformations so that errors are not propagated. Such errors of circular reasoning can be documented \cite{lovell2000penultimate} for many early cases, such as high-energy eclipsed $\chi$ angles added for "completeness", or real empirical data clusters caused by incorrect backward-fit branched sidechains. The accuracy of these libraries depends on including only reliably modeled sidechains in the reference dataset. All rotamer libraries filter their datasets at the file level by resolution and redundancy. As the PDB grew in size, it  became increasingly practical to filter also at the residue level. This process very effectively lowers noise and sharpens clustering, because even at high resolution the poorly ordered regions are susceptible to misfitting and are often worse than the good parts at low resolution.

Previously our group developed the "penultimate" rotamer library, using the quality-filtered Top240 PDBs \cite{lovell2000penultimate}. Soon afterward we updated the library using our Top500 dataset \cite{Lovell:2003uq}. This library used many file-level filters such as requiring $\le$ 1.8 resolution, a clashscore $<$ 30 \cite{Word1999}, and few backbone bond-angle outliers from Engh and Huber standards \cite{Engh1991}, \textcolor{red}{and when the file contained multiple identical changes, used only the best-ordered one}. The residue-level filters required a B factor $<$ 40 for all atoms in the residue and the absence of serious steric clashes, defined as hydrogen-aware atomic overlaps $\ge$ 0.4 \AA \cite{Word1999}. These filters were used in order to eliminate residues with questionable justification for their given conformation, thereby increasing reliability. Specifically, the B-factor filter (the best metric available before mandatory data deposition) was meant to eliminate residues with poor electron density or other local uncertainty. However, as we realized and as Shapovalov and Dunbrack later clearly demonstrated \cite{Shapovalov:2007}, in many structures the B factors are a poor indicator of good density, primarily because they are often restrained to change only modestly between adjacent, covalently bonded atoms. Since 2008, when the wwPDB started requiring structure-factor data with all depositions, it has become feasible to do routine analysis of electron density directly.

In the current work we use a new quality-filtered dataset curated by our lab, the Top8000, to develop a new rotamer library. The main differences between this dataset and our previous dataset are sheer size (8000 vs. 500 chains) and improved quality filters, which are stricter and better balanced at the \textcolor{red}{overall file (or chain)} level and especially at the residue level. We now use a three-component residue filter that adds real-space correlation coefficient (RSCC) and local map value to B factor, effectively eliminating all residues with poor electron density. We explain how these strict filters reveal authentic, rare, and interesting rotameric states, including cases where bond angles must open up significantly. The improved statistics enable a three-level rotamer classification for validation of \textit{favored}, \textit{allowed}, and \textit{outlier} (analogous to classic Ramachandran measures), where now only 0.3\%, rather than the previous 1.0\%, of the high-quality, filtered reference data lies outside both the \textit{allowed} and the \textit{favored} regions.
